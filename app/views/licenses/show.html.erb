<% title "#{@license.name} license - Libraries" %>

<h1>
  <%= @license.name %>
  <% if @license.osi_approved? %>
    <small>OSI Approved</small>
  <% end %>
</h1>
<% url = "http://spdx.org/licenses/#{@license.id}" %>
<%= link_to url, url %>
<hr>
<div class='row'>
  <% if @popular.any? %>
  <div class='col-md-4'>
    <h4>Popular <%= @license.id %> Projects</h4>
    <% @popular.each do |project| %>
    <div class='project'>
      <strong><%= link_to project.name, project_path(project.to_param) %></strong>
      <small>
        - <%= number_with_delimiter project.github_repository.stargazers_count %> stars
      </small>
      <br />
      <%= truncate project.description, :length => 100 %>
      <br /><br />
    </div>
    <% end %>
    <p>
      <%= link_to 'See more &raquo;'.html_safe, search_path(licenses: @license.id, sort: 'stars', order: 'desc') %>
    </p>
  </div>
  <% end %>

  <% if @updated.any? %>
  <div class='col-md-4'>
    <h4>Updated <%= @license.id %> Projects</h4>
    <% @updated.each do |project| %>
    <div class='project'>
      <strong><%= link_to project.name, project_path(project.to_param) %></strong>
      <small>
        - Updated <%= time_ago_in_words project.updated_at %> ago
      </small>
      <br />
      <%= truncate project.description, :length => 100 %>
      <br /><br />
    </div>
    <% end %>
    <p>
      <%= link_to 'See more &raquo;'.html_safe, search_path(licenses: @license.id, sort: 'updated_at', order: 'desc') %>
    </p>
  </div>
  <% end %>

  <% if @created.any? %>
  <div class='col-md-4'>
    <h4>New <%= @license.id %> Projects</h4>
    <% @created.each do |project| %>
    <div class='project'>
      <strong><%= link_to project.name, project_path(project.to_param) %></strong>
      <small>
        - Published <%= time_ago_in_words project.updated_at %> ago
      </small>
      <br />
      <%= truncate project.description, :length => 100 %>
      <br /><br />
    </div>
    <% end %>
    <p>
      <%= link_to 'See more &raquo;'.html_safe, search_path(licenses: @license.id, sort: 'created_at', order: 'desc') %>
    </p>
  </div>
  <% end %>
</div>

<div class='row'>
  <% if @languages.any? %>
  <div class='col-md-4'>
    <h4>Popular <%= @license.id %> Languages</h4>
    <% @languages.each do |language| %>
    <p>
      <strong><%= link_to language.term, search_path(languages: language.term, licenses: @license.id) %></strong> -
      <%= number_with_delimiter language['count'] %>
    </p>
    <% end %>
  </div>
  <% end %>
  <% if @platforms.any? %>
  <div class='col-md-4'>
    <h4>Popular <%= @license.id %> Platforms</h4>
    <% @platforms.each do |platform| %>
      <p>
        <strong><%= link_to platform.term, search_path(licenses: @license.id, platforms: platform.term) %></strong> -
        <%= number_with_delimiter platform['count'] %>
      </p>
    <% end %>
  </div>
  <% end %>
</div>
