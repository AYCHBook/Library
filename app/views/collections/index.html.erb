<% title "Explore - Libraries" %>
<% description "Find popular and trending libraries by language and keyword" %>

<h1>Explore</h1>

<% cache 'collections:index', expires_in: 1.day do  %>
  <div class="row">
    <% @languages.each_with_index do |language, index| %>
      <% if ((index + 6) % 8).zero? %>
        <div class="col-md-4 collection">
          <%= render 'adsense/sidebar' %>
        </div>
      <% end %>
      <% keywords = Project.popular_keywords({filters: {language: [language]}}).map{|k| k[:term].downcase }.uniq.first(10) %>
      <% next if keywords.length < 5 %>
      <div class="col-md-4 collection">
        <h3>
          <%= link_to language_path(language.downcase) do %>
            <div class="pictogram pictogram pictogram-<%= language.downcase %>"></div>
            <%= language %>
          <% end %>
        </h3>
        <ul>
          <% keywords.each do |keyword| %>
            <% next if keyword.blank? %>
            <li>
              <a href="/explore/<%= ERB::Util.url_encode(language.downcase) %>-<%= keyword %>-libraries">
                <%= keyword %> libraries
              </a>
            </li>
          <% end %>
        </ul>
      </div>
    <% end %>
  </div>
<% end %>
