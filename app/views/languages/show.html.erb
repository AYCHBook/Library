<% title "#{@language} - Libraries" %>

<h1><%= @language %></h1>
<hr>
<div class='row'>
  <% cache("language:#{@language}:popular", :expires_in => 1.day) do %>
    <% popular = Project.popular(filters: { language: @language }).first(5) %>
    <% if popular.any? %>
    <div class='col-md-4'>
      <h4>Popular <%= @language %> Projects</h4>
      <%= render popular %>
      <p>
        <%= link_to 'See more &raquo;'.html_safe, search_path(languages: @language, order: 'desc') %>
      </p>
    </div>
    <% end %>
  <% end %>

  <% if @updated.any? %>
  <div class='col-md-4'>
    <h4>Updated <%= @language %> Projects</h4>
    <%= render @updated %>
    <p>
      <%= link_to 'See more &raquo;'.html_safe, search_path(languages: @language, sort: 'updated_at', order: 'desc') %>
    </p>
  </div>
  <% end %>

  <% if @created.any? %>
  <div class='col-md-4'>
    <h4>New <%= @language %> Projects</h4>
    <%= render @created %>
    <p>
      <%= link_to 'See more &raquo;'.html_safe, search_path(languages: @language, sort: 'created_at', order: 'desc') %>
    </p>
  </div>
  <% end %>
</div>
<hr>
<div class='row'>
  <% cache("language:#{@language}:licenses", :expires_in => 1.day) do %>
    <% licenses = Project.popular_licenses(filters: { language: @language }).first(8) %>
    <% if licenses.any? %>
      <div class='col-md-4'>
        <h4>Popular <%= @language %> Licenses</h4>
        <%= render partial: 'licenses/list_license', collection: licenses, as: :license %>
      </div>
    <% end %>
  <% end %>

  <% cache("language:#{@language}:platforms", :expires_in => 1.day) do %>
    <% platforms = Project.popular_platforms(filters: { language: @language }).first(10) %>
    <% if platforms.length > 1 %>
      <div class='col-md-4'>
        <h4>Popular <%= @language %> Platforms</h4>
        <%= render partial: 'platforms/list_platform', collection: platforms, as: :platform %>
      </div>
    <% end %>
  <% end %>
</div>
