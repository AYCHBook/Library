<% title "#{params[:keyword].humanize} libraries written in #{@language} - Libraries.io" %>
<% description "Find popular and trending #{params[:keyword].humanize} libraries written in #{@language}" %>

<h1>
  <div class="pictogram pictogram-lg pictogram-<%= @language.downcase %>"></div>
  <%= params[:keyword].humanize %> libraries written in <%= @language %>
</h1>

<div class="col-sm-8">
  <%= render 'adsense/banner' %>
  <%= render @projects %>
  <%= will_paginate @search %>
</div>
<div class='col-sm-4 facets'>
  <%= render 'adsense/sidebar' %>
  <% @search.response.facets.each do |name, facet| %>
    <% next if facet['terms'].empty? %>
    <% next if name == 'languages' %>
    <h4>Filter by <%= name.humanize %></h4>
    <ul class='filter'>
      <% facet['terms'].each do |term| %>
        <% next if term['term'].blank? %>
        <% active = term['term'] == params[name.to_sym] %>
        <li class='<%= 'active' if active %>'>
          <% if active %>
            <%= link_to platform_name(term['term']), url_for(params.merge(name.to_sym => nil, page: nil)) %>
          <% else %>
            <%= link_to platform_name(term['term']), url_for(params.merge(name.to_sym => term['term'], page: nil)) %>
            <small><%= number_to_human term['count'] %></small>
          <% end %>
        </li>
      <% end %>
      <% if params[name.to_sym].present? && !facet['terms'].map{|t| t['term']}.include?(params[name.to_sym]) %>
        <li class='active'>
          <%= link_to platform_name(params[name.to_sym]), url_for(params.merge(name.to_sym => nil, page: nil)) %>
        </li>
      <% end %>
    </ul>
  <% end %>
</div>
